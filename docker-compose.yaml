services:
  hytale:
    build:
      context: .
      dockerfile: Dockerfile
    image: hytale-server:local
    container_name: hytale-server
    # Image runs a dedicated non-root user (`hytale`); do not override the runtime user here to avoid permission mismatches.
    env_file: .env
    working_dir: /hytale
    environment:
      - SERVERFILESPATH=${SERVERFILESPATH:-./data}
    # Bind-mount a host path into the container; set SERVERFILESPATH on the host or use ./data by default
    volumes:
      - "${SERVERFILESPATH:-./data}:/hytale/data:rw"
    restart: unless-stopped

# Usage notes:
# - Set SERVERFILESPATH to an absolute path on the host (eg: /home/user/hytale-data) before running
#   to control where server files are persisted. If not set, `./data` in the compose folder will be used.
# - If you need host UID/GID mapping, you can set PUID/PGID in `.env`, but avoid overriding the container user unless you handle permissions intentionally.
# - To start an interactive shell: `docker compose run --rm hytale` or `docker compose up` then `docker compose exec hytale bash`.
